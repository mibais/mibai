import{_ as P}from"./index.vue_vue_type_script_setup_true_lang-D8WjjPV0.js";import{_ as Z}from"./edit.vue_vue_type_script_setup_true_lang-CSu5g7a3.js";import{_ as q}from"./cover.vue_vue_type_script_setup_true_lang-BA5cMkj2.js";import{f as K,g as L}from"./shop-DK2aaRFI.js";import{u as W}from"./index-DcB7UUez.js";import{a_ as X,a$ as Y,aR as ee,Z as te,$ as ae,ah as ne,S as oe,w as se,ai as le,I as ue,l as ie,Q as _e,ag as de,a9 as pe,aB as re,at as ce,r as me,as as fe}from"./antd-CHYaqX98.js";import{d as ge,f as c,s as ve,r as ye,o as xe,a5 as i,ac as m,ad as e,k as t,u as a,G as l,a3 as z,F as B,af as ke,ag as d,ak as O,H as Ce,a8 as we}from"./vue-DZ3ObLO4.js";import"./context-CI8FevHi.js";import"./coverEdit.vue_vue_type_script_setup_true_lang-B_hYjia0.js";const he=we("span",{"text-20px":"","line-height-32px":"","mr-12px":"","mb-0":"",truncate:"","font-600":""},"商品管理",-1),De=ge({__name:"index",setup(Se){const f=c(!1),p=c(!1),M=ve([{title:"#",dataIndex:"id"},{title:"商品名称",dataIndex:"name"},{title:"价格",dataIndex:"price",width:120,ellipsis:!0},{title:"流量",dataIndex:"bandwidth"},{title:"分组",dataIndex:"nodeGroup"},{title:"状态",dataIndex:"status"},{title:"操作",dataIndex:"action",width:200}]),x=c(0),h=c(),u=ye({pageSize:10,current:1,total:0,pageSizeOptions:["10","20","30","40"],showSizeChanger:!0,showQuickJumper:!0,showTotal:o=>`${o}条记录`,onChange(o,n){u.pageSize=n,u.current=o,g()}}),r=c({name:void 0,status:void 0});async function g(){if(!f.value){f.value=!0;try{const{data:o}=await K({size:u.pageSize,current:u.current,param:r.value});h.value=o.records,u.total=o.total,u.pageSize=o.size,u.current=o.current}finally{f.value=!1}}}function N(){g()}function V(o){x.value=o.id,p.value=!0}async function D(o){await L(o),W().success("商品删除成功"),await g()}function F(){x.value=void 0,p.value=!0}function G(o){p.value=!1,o&&g()}const _=c(!1);return xe(()=>{g()}),(o,n)=>{const Q=te,S=ae,k=ne,b=oe,R=se,C=le,v=ue,w=ie,U=_e,$=de,I=pe,A=re,H=ce,T=me,j=fe,E=P;return i(),m(E,null,{title:e(()=>[he]),default:e(()=>[t($,{"mb-4":""},{default:e(()=>[t(U,{modal:a(r)},{default:e(()=>[t(C,{gutter:16},{default:e(()=>[t(k,{span:12},{default:e(()=>[t(S,{label:"商品名",name:"name"},{default:e(()=>[t(Q,{value:a(r).name,"onUpdate:value":n[0]||(n[0]=s=>a(r).name=s)},null,8,["value"])]),_:1})]),_:1}),t(k,{span:12},{default:e(()=>[t(S,{label:"状态",name:"status"},{default:e(()=>[t(R,{value:a(r).status,"onUpdate:value":n[1]||(n[1]=s=>a(r).status=s)},{default:e(()=>[t(b,{value:1},{default:e(()=>[l(" 上架 ")]),_:1}),t(b,{value:0},{default:e(()=>[l(" 下架 ")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),t(C,{span:24,style:{"text-align":"right"}},{default:e(()=>[t(k,{span:24},{default:e(()=>[t(w,{flex:"","justify-end":"","w-full":""},{default:e(()=>[t(v,{loading:a(f),type:"primary",onClick:N},{default:e(()=>[l(" 查询 ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modal"])]),_:1}),t(C,{gutter:24},{default:e(()=>[t(k,{span:24},{default:e(()=>[t($,{title:"商品列表"},{extra:e(()=>[t(w,null,{default:e(()=>[t(v,{type:"default",size:"middle",onClick:F},{icon:e(()=>[t(a(X))]),default:e(()=>[l(" 添加商品 ")]),_:1}),t(v,{type:"default",size:"middle",onClick:n[2]||(n[2]=s=>_.value=!0)},{icon:e(()=>[t(a(Y))]),default:e(()=>[l(" 管理封页 ")]),_:1})]),_:1})]),default:e(()=>[t(H,{loading:a(f),columns:a(M),"data-source":a(h),pagination:a(u),scroll:{x:100}},{bodyCell:e(({column:s,record:y})=>[s.dataIndex==="bandwidth"?(i(),z(B,{key:0},[l(ke(y.content.bandwidth)+" GB ",1)],64)):d("",!0),s.dataIndex==="status"?(i(),z(B,{key:1},[y.status===1?(i(),m(I,{key:0,color:"#108ee9"},{default:e(()=>[l(" 上架中 ")]),_:1})):d("",!0),y.status===0?(i(),m(I,{key:1,color:"#f50"},{default:e(()=>[l(" 已下架 ")]),_:1})):d("",!0)],64)):d("",!0),s.dataIndex==="action"?(i(),m(w,{key:2},{default:e(()=>[t(v,{type:"primary",onClick:J=>V(y)},{default:e(()=>[l(" 修改 ")]),_:2},1032,["onClick"]),t(A,{title:"确定要删除节点吗？",onConfirm:J=>D(y.id)},{icon:e(()=>[t(a(ee))]),default:e(()=>[t(v,{danger:"",type:"primary"},{default:e(()=>[l(" 删除 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:2},1024)):d("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1})]),_:1})]),_:1}),t(T,{title:a(x)?"编辑商品":"添加商品",width:720,visible:a(p),"body-style":{paddingBottom:"80px"},onClose:n[3]||(n[3]=s=>p.value=!1)},{default:e(()=>[a(p)?(i(),m(O(Z),{key:0,"shop-id":a(x),onHandleClose:G},null,40,["shop-id"])):d("",!0)]),_:1},8,["title","visible"]),t(j,{open:a(_),"onUpdate:open":n[4]||(n[4]=s=>Ce(_)?_.value=s:null),width:800,title:"管理封页","mask-closable":!1,onCancel:n[5]||(n[5]=s=>_.value=!1),onOk:n[6]||(n[6]=s=>_.value=!1)},{default:e(()=>[a(_)?(i(),m(O(q),{key:0})):d("",!0)]),_:1},8,["open"])]),_:1})}}});export{De as default};
