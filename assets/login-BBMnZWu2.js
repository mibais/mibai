var ae=Object.defineProperty;var ie=(n,o,a)=>o in n?ae(n,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[o]=a;var f=(n,o,a)=>(ie(n,typeof o!="symbol"?o+"":o,a),a);import{_ as ce}from"./index.vue_vue_type_script_setup_true_lang-DPnFuiPM.js";import{_ as re,a as le,b as pe}from"./login-left-BnbAcdUE.js";import{_ as ue}from"./logo-CmUnSVuR.js";import{j as I,f as de,k as M,g as me,m as q,A as he,_ as _e,n as ge}from"./index-DbuHkAAg.js";import{g as b}from"./tools-Dmq7n5iD.js";import{d as k,W as fe,r as ve,s as $,f as K,ap as be,o as A,u as e,j as we,a3 as E,a8 as i,af as v,ac as z,k as c,ad as m,aq as P,a5 as g,ag as ye,G as O,a6 as xe,a7 as ke,ak as Ce}from"./vue-CP9fVXMC.js";import{I as Le,W as $e,U as ze,X as Ie,Y as Me,Z as qe,$ as Ae,Q as Ee,T as Pe,J as Se,a0 as Te,a1 as Be,a2 as Oe,a3 as We,K as Re}from"./antd-BiDZImxE.js";var Ue=async(n=0)=>new Promise(o=>{const a=setTimeout(()=>{o(!0),clearTimeout(a)},n)});const t={width:0,height:0,canvas:null,ctx:null,circles:[],animate:!0,requestId:null},je=function(n){if(!t||!n)throw new Error("no canvasInstance");t.width=window.innerWidth,t.height=window.innerHeight,t.canvas=n,t.canvas.width=t.width,t.canvas.height=t.height,t.ctx=t.canvas.getContext("2d"),t.circles=[];for(let o=0;o<t.width*.5;o++){const a=new Ge;t.circles.push(a)}H(),Ne()};function V(){t.animate=!(document.body.scrollTop>t.height)}function F(){t.width=window.innerWidth,t.height=window.innerHeight,t.canvas.width=t.width,t.canvas.height=t.height}function H(){if(t.animate){t.ctx.clearRect(0,0,t.width,t.height);for(const n in t.circles)t.circles[n].draw()}t.requestId=requestAnimationFrame(H)}class Ge{constructor(){f(this,"pos");f(this,"alpha");f(this,"scale");f(this,"velocity");f(this,"draw");this.pos={x:Math.random()*t.width,y:t.height+Math.random()*100},this.alpha=.1+Math.random()*.3,this.scale=.1+Math.random()*.3,this.velocity=Math.random();const o=Math.random()*255,a=Math.random()*255,u=Math.random()*255;this.draw=function(){this.pos.y-=this.velocity,this.alpha-=5e-4,t.ctx.beginPath(),t.ctx.arc(this.pos.x,this.pos.y,this.scale*10,0,2*Math.PI,!1),t.ctx.fillStyle=`rgba(${o},${a},${u},${this.alpha})`,t.ctx.fill()}}}function Ne(){window.addEventListener("scroll",V),window.addEventListener("resize",F)}function Ke(){window.removeEventListener("scroll",V),window.removeEventListener("resize",F),cancelAnimationFrame(t.requestId)}const G={init:je,removeListeners:Ke},W=n=>(xe("data-v-6ac26878"),n=n(),ke(),n),Ve={class:"login-container"},Fe={"h-screen":"","w-screen":"",absolute:"","z-10":""},He={class:"login-content flex-center"},De={class:"ant-pro-form-login-main rounded"},Qe={class:"flex-between h-15 px-4 mb-[2px]"},Ze={class:"flex-end"},Je=W(()=>i("span",{class:"ant-pro-form-login-logo"},[i("img",{"w-full":"","h-full":"","object-cover":"",src:ue})],-1)),Xe=W(()=>i("span",{class:"ant-pro-form-login-title"}," 米白云 ",-1)),Ye={class:"ant-pro-form-login-desc"},et={class:"login-lang flex-center relative z-11"},tt={class:"box-border flex min-h-[520px]"},ot=W(()=>i("div",{class:"ant-pro-form-login-main-left min-h-[520px] flex-center bg-[var(--bg-color-container)]"},[i("img",{src:re,class:"h-5/6 w-5/6"})],-1)),st={class:"ant-pro-form-login-main-right px-5 w-[335px] flex-center flex-col relative z-11"},nt={class:"text-center py-6 text-2xl"},at={class:"mb-24px flex-between"},it={href:"/forget"},ct={class:"text-slate-500"},rt={class:"ant-pro-form-login-other"},lt=60,pt=k({__name:"login-sys",setup(n){const o=I(),a=de(),{layoutSetting:u}=fe(a),d=P(),l=M(),s=ve({email:void 0,password:void 0,mobile:void 0,code:void 0,type:"account",remember:!0}),{t:r}=me(),w=$(),y=$(!1),C=$(!1),L=K(),{pause:D}=be(1e3,{controls:!0,immediate:!1,callback(h){h&&h===lt&&D()}});function Q(){let h=window.location.host.includes("high")?"Ov23liOEpzTZf7mt98Bj":"de35e0cc0e281d788019";window.location.href=`https://github.com/login/oauth/authorize?client_id=${h}&&redirect_uri=https://mibais.github.io/login?type=github`}function Z(){window.location.href="https://openauth.alipay.com/oauth2/publicAppAuthorize.htm?app_id=2019111369130198&scope=auth_user&redirect_uri=https://mibais.github.io/login?type=alipay"}function J(){window.location.href="https://accounts.google.com/o/oauth2/v2/auth?scope=https://www.googleapis.com/auth/userinfo.email&include_granted_scopes=true&response_type=token&redirect_uri=https://mibais.github.io/login&state=google&client_id=1085614457190-vd0bt5slhitqelu6qhpb6444luc3rmi4.apps.googleusercontent.com"}async function S(){var h;y.value=!0;try{await((h=w.value)==null?void 0:h.validate());const p={email:s.email,password:s.password,type:"sys"},{data:x}=await q(p);l.value=x==null?void 0:x.token,o.success({message:"登录成功",description:"欢迎回来！",duration:3});const T=b("redirect","/");await d.push({path:T,replace:!0})}catch(p){p instanceof he&&(C.value=!0),y.value=!1}}return A(async()=>{await Ue(300),G.init(e(L))}),we(()=>{G.removeListeners()}),(h,p)=>{const x=le,T=pe,X=ce,B=Le,R=Ee,Y=Pe,ee=Se,te=Te,U=Be,oe=Oe,se=We,j=Re,ne=$e;return g(),E("div",Ve,[i("div",Fe,[i("canvas",{ref_key:"bubbleCanvas",ref:L},null,512)]),i("div",He,[i("div",De,[i("div",Qe,[i("div",Ze,[Je,Xe,i("span",Ye,v(e(r)("pages.layouts.userLayout.title")),1)]),i("div",et,[i("span",{class:"flex-center cursor-pointer text-16px",onClick:p[0]||(p[0]=_=>e(a).toggleTheme(e(u).theme==="dark"?"light":"dark"))},[e(u).theme==="light"?(g(),z(x,{key:0})):(g(),z(T,{key:1}))]),c(X)])]),c(B,{"m-0":""}),i("div",tt,[ot,c(B,{"m-0":"",type:"vertical",class:"ant-pro-login-divider min-h-[520px]"}),i("div",st,[i("div",nt,v(e(r)("pages.login.tips")),1),c(ne,{ref_key:"formRef",ref:w,model:e(s)},{default:m(()=>[c(Y,{activeKey:e(s).type,"onUpdate:activeKey":p[1]||(p[1]=_=>e(s).type=_),centered:""},{default:m(()=>[c(R,{key:"account",tab:e(r)("pages.login.accountLogin.tab")},null,8,["tab"]),c(R,{key:"mobile",disabled:"",tab:e(r)("pages.login.phoneLogin.tab")},null,8,["tab"])]),_:1},8,["activeKey"]),e(C)?(g(),z(ee,{key:0,"mb-24px":"",message:e(r)("pages.login.accountLogin.errorMessage"),type:"error","show-icon":""},null,8,["message"])):ye("",!0),c(U,{name:"email",rules:[{required:!0,message:e(r)("pages.login.email.required")}]},{default:m(()=>[c(te,{value:e(s).email,"onUpdate:value":p[2]||(p[2]=_=>e(s).email=_),"allow-clear":"",autocomplete:"off",placeholder:e(r)("pages.login.email.placeholder"),size:"large",onPressEnter:S},{prefix:m(()=>[c(e(ze))]),_:1},8,["value","placeholder"])]),_:1},8,["rules"]),c(U,{name:"password",rules:[{required:!0,message:e(r)("pages.login.password.required")}]},{default:m(()=>[c(oe,{value:e(s).password,"onUpdate:value":p[3]||(p[3]=_=>e(s).password=_),"allow-clear":"",placeholder:e(r)("pages.login.password.placeholder"),size:"large",onPressEnter:S},{prefix:m(()=>[c(e(Ie))]),_:1},8,["value","placeholder"])]),_:1},8,["rules"]),i("div",at,[c(se,{checked:e(s).remember,"onUpdate:checked":p[4]||(p[4]=_=>e(s).remember=_)},{default:m(()=>[O(v(e(r)("pages.login.rememberMe")),1)]),_:1},8,["checked"]),i("a",it,v(e(r)("pages.login.forgotPassword")),1)]),c(j,{type:"primary",block:"",loading:e(y),size:"large",onClick:S},{default:m(()=>[O(v(e(r)("pages.login.submit")),1)]),_:1},8,["loading"]),c(j,{"mt-5":"",block:"",href:"/register"},{default:m(()=>[O(" 没有账号？去注册 ")]),_:1})]),_:1},8,["model"]),c(B,null,{default:m(()=>[i("span",ct,v(e(r)("pages.login.loginWith")),1)]),_:1}),i("div",rt,[c(e(Me),{class:"icon",onClick:Q}),c(e(qe),{disabled:"",class:"icon",onClick:Z}),c(e(Ae),{disabled:"",class:"icon",onClick:J})])])])])])])}}}),N=_e(pt,[["__scopeId","data-v-6ac26878"]]),ut=k({__name:"login-github",setup(n){const o=M(),a=P(),u=I();async function d(){const{data:l}=await q({type:"github",code:b("code")});o.value=l==null?void 0:l.token,u.success({message:"登录成功",description:"欢迎回来！",duration:3});const s=b("redirect","/");a.push({path:s,replace:!0})}return A(()=>{d()}),(l,s)=>(g(),E("div"))}}),dt=k({__name:"login-alipay",setup(n){const o=M(),a=P(),u=I();async function d(){const{data:l}=await q({type:"alipay",code:b("auth_code")});o.value=l==null?void 0:l.token,u.success({message:"登录成功",description:"欢迎回来！",duration:3});const s=b("redirect","/");a.push({path:s,replace:!0})}return A(()=>{d()}),(l,s)=>(g(),E("div"))}}),mt=k({__name:"login-google",props:{hashParams:{type:Object,required:!0}},setup(n){const o=n,a=M(),u=P(),d=I();async function l(){const{data:s}=await q({type:"google",code:o.hashParams.access_token});a.value=s==null?void 0:s.token,d.success({message:"登录成功",description:"欢迎回来！",duration:3}),u.push({path:"/",replace:!0})}return A(()=>{l()}),(s,r)=>(g(),E("div"))}}),xt=k({__name:"login",setup(n){const o=$(),a={sys:N,github:ut,alipay:dt,google:mt},u=K(l());let d=b("type");d||(d=u.value.state??""),o.value=a[d]??N;function l(){const r=ge.currentRoute.value.hash.substring(1).split("&"),w={};return r.forEach(y=>{const[C,L]=y.split("=");w[C]=L}),w}return(s,r)=>(g(),z(Ce(e(o)),{"hash-params":e(u)},null,8,["hash-params"]))}});export{xt as default};
