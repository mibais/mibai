import{_ as M}from"./coverEdit.vue_vue_type_script_setup_true_lang-B_hYjia0.js";import{a as N,d as $}from"./shop-DK2aaRFI.js";import{u as R}from"./index-DcB7UUez.js";import{aR as V,I as A,l as D,aB as O,at as E,as as F}from"./antd-CHYaqX98.js";import{d as Q,f as i,r as T,o as G,a5 as m,a3 as H,k as s,ad as a,G as _,ac as g,u as l,ag as k,a8 as J,af as U,ak as j,H as q,F as K}from"./vue-DZ3ObLO4.js";const L={style:{margin:"0"}},ae=Q({__name:"cover",setup(P){const c=i(!1),t=i(!1),C=i([{title:"#",dataIndex:"coverId",key:"coverId"},{title:"名称",dataIndex:"shopName",key:"shopName"},{title:"价格",dataIndex:"price",key:"price"},{title:"周期",dataIndex:"cycle",key:"cycle"},{title:"排序",dataIndex:"orderIndex",key:"orderIndex"},{title:"描述",dataIndex:"item",key:"item"},{title:"操作",dataIndex:"action",key:"action",width:200}]),f=i(),n=T({pageSize:10,current:1,total:0,pageSizeOptions:["10","20","30","40"],showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`${e}条记录`,onChange(e,o){n.pageSize=o,n.current=e,d()}});async function d(){if(!c.value){c.value=!0;try{const{data:e}=await N({size:n.pageSize,current:n.current});f.value=e.records,n.total=e.total,n.pageSize=e.size,n.current=e.current}finally{c.value=!1}}}async function x(e){await $(e),R().success("封页删除成功",2)}const u=i();function I(e){u.value=e.coverId,t.value=!0}function h(){u.value=void 0,t.value=!0}function w(e){t.value=!1,e&&d()}return G(()=>{d()}),(e,o)=>{const p=A,v=D,z=O,S=E,b=F;return m(),H(K,null,[s(v,{"mb-5":""},{default:a(()=>[s(p,{type:"primary",onClick:h},{default:a(()=>[_(" 添加 ")]),_:1})]),_:1}),s(S,{loading:l(c),columns:l(C),"data-source":l(f),pagination:l(n),scroll:{x:100},"expand-column-width":100},{bodyCell:a(({column:r,record:y})=>[r.dataIndex==="action"?(m(),g(v,{key:0},{default:a(()=>[s(p,{type:"primary",onClick:B=>I(y)},{default:a(()=>[_(" 编辑 ")]),_:2},1032,["onClick"]),s(z,{title:"确定要删除封页吗？",onConfirm:B=>x(y.id)},{icon:a(()=>[s(l(V))]),default:a(()=>[s(p,{type:"primary",danger:""},{default:a(()=>[_(" 删除 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:2},1024)):k("",!0)]),expandedRowRender:a(({record:r})=>[J("p",L,U(r.item),1)]),_:1},8,["loading","columns","data-source","pagination"]),s(b,{open:l(t),"onUpdate:open":o[0]||(o[0]=r=>q(t)?t.value=r:null),closable:!1,"mask-closable":!1,onCancel:o[1]||(o[1]=r=>t.value=!1),onOk:o[2]||(o[2]=r=>t.value=!1)},{footer:a(()=>[]),default:a(()=>[l(t)?(m(),g(j(M),{key:0,"cover-id":l(u),onCloseModal:w},null,40,["cover-id"])):k("",!0)]),_:1},8,["open"])],64)}}});export{ae as _};
