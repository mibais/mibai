import{b9 as Y,d as A,S as I,m as F,J as j,a0 as q,ao as E,aa as H,ab as J,ba as O,av as z,am as K}from"./antd-ClWK_BPx.js";import{c as L,b as Q}from"./bought-BbQUgbKi.js";import{u as W,a as X}from"./index-E9vVtGBC.js";import{d as Z,f as l,c as ee,w as ae,o as ne,ab as te,a5 as w,a3 as oe,k as e,ad as a,u as n,G as s,a8 as c,ac as le,af as i,ag as se,H as k,F as ue}from"./vue-DIvP5FMT.js";const _e=c("br",null,null,-1),fe=Z({__name:"traffic-package",setup(re){const t=l(10),u=l(!1),b=l(!1),G=l(!1),m=l(0),B=l(),x=W(),f=X(),p=ee(()=>t.value*m.value);ae(p,_=>{G.value=_>f.userInfo.money});const C=l({100:"100GB",300:"300GB",500:{style:{color:"#f50"},label:"500GB"},700:"700GB",1e3:"1000GB"});async function M(){const{data:_}=await L();_&&(b.value=!0,m.value=_.unitPrice,B.value=_.nextRestTime?A(_.nextRestTime).format("YYYY-MM-DD"):"永不到期")}function P(){b.value?u.value=!0:(u.value=!1,x.warning("需要先购买套餐"))}const d=l(!1);async function T(){if(p.value>f.userInfo.money){d.value=!0;return}await Q(t.value),u.value=!1,x.success("流量购买成功！")}return ne(()=>{M()}),(_,o)=>{const v=I,h=F,D=te("router-link"),S=j,$=q,N=E,g=H,y=J,R=O,U=z,V=K;return w(),oe(ue,null,[e(v,{type:"primary",onClick:P},{icon:a(()=>[e(n(Y))]),default:a(()=>[s(" 购买流量包 ")]),_:1}),e(V,{open:n(u),"onUpdate:open":o[3]||(o[3]=r=>k(u)?u.value=r:null),title:"购买流量包",width:"680px"},{footer:a(()=>[e(h,null,{default:a(()=>[e(v,{style:{"margin-right":"8px"},onClick:o[0]||(o[0]=r=>{u.value=!1,d.value=!1})},{default:a(()=>[s("取消")]),_:1}),e(v,{type:"primary",onClick:T},{default:a(()=>[s("购买")]),_:1})]),_:1})]),default:a(()=>[c("div",null,[n(d)?(w(),le(S,{key:0,type:"info"},{message:a(()=>[s(i(`余额不足。流量包总价${n(p)}元，账户余额${n(f).userInfo.money}元`)+"。请先 ",1),e(D,{to:"/charge/wallet"},{default:a(()=>[s("充值")]),_:1})]),_:1})):se("",!0),e(y,null,{default:a(()=>[e(g,{span:24},{default:a(()=>[e(N,null,{default:a(()=>[c("blockquote",null,[s(" 购买的流量包与当前套餐绑定，并只在当前周期有效。"),_e,s("当前周期到期时间："),e($,{color:"#108ee9"},{default:a(()=>[s(i(n(B)),1)]),_:1})])]),_:1})]),_:1})]),_:1}),e(y,{gutter:42},{default:a(()=>[e(g,{xs:24,sm:24,md:16,lg:16},{default:a(()=>[e(R,{value:n(t),"onUpdate:value":o[1]||(o[1]=r=>k(t)?t.value=r:null),min:1,max:1e3,step:5,marks:n(C)},null,8,["value","marks"])]),_:1}),e(g,{md:8,lg:8},{default:a(()=>[e(U,{value:n(t),"onUpdate:value":o[2]||(o[2]=r=>k(t)?t.value=r:null),placeholder:"输入你要购买的流量","addon-after":"GB",min:1,max:1e3,step:5},null,8,["value"])]),_:1})]),_:1}),e(y,{"mt-5":""},{default:a(()=>[c("ul",null,[c("li",null,"当前套餐单价："+i(n(m))+"元/GB",1),c("li",null,"流量总计价格："+i(n(p))+"元",1)])]),_:1})])]),_:1},8,["open"])],64)}}});export{fe as _};
