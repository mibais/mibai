import{u as U,_ as j}from"./index-Bem8UvUJ.js";import{Z as K,$ as R,I as V,Q as D,aM as O,ag as G}from"./antd-C7ILtrJb.js";import{d as Q,f as v,w as k,a5 as g,ac as h,ad as n,U as w,k as f,u,a3 as Z,F as q,al as z,G as I,af as C,ag as A,y as S}from"./vue-BPQYEdcZ.js";const H=Q({__name:"index",props:{length:{type:Number,default:6},warningMessage:{type:String,default:"请补全验证码"},countdown:{type:Number,default:60},resend:{type:Boolean,default:!1},verifyLoading:{type:Boolean,default:!0},immediate:{type:Number,default:0},sendText:{type:String,default:"提交"}},emits:["handleSubmit","handleResend"],setup(p,{emit:$}){const a=p,y=$,o=v({}),l=v(!1),B=U();let _=null;const i=v(0);k(()=>a.length,()=>{for(let e=0;e<a.length;e++)o.value[`code${e}`]=""},{immediate:!0});async function N(){const e=Object.values(o.value).join("");if(e.length!==a.length){B.warning(a.warningMessage);return}y("handleSubmit",e)}function x(e,t){var r;const s=(r=t.target)==null?void 0:r.value;if(o.value[`code${e}`]=s,s&&e<a.length-1){const c=t.target.nextElementSibling;c&&S(()=>{c.focus()})}}function T(e,t){if(t.key==="Backspace"&&!t.target.value&&e>0){const s=t.target.previousElementSibling;s&&S(()=>{s.focus()})}}function b(e){const t=e;i.value=t,_||(_=setInterval(()=>{i.value>0&&i.value<=t?i.value--:(l.value=!1,clearInterval(_),_=null)},1e3))}function M(){if(!l.value){l.value=!0;try{y("handleResend"),b(a.countdown)}catch{l.value=!1}}}return k(()=>a.immediate,e=>{a.resend&&e>0&&(l.value=!0,b(a.immediate))},{immediate:!0}),(e,t)=>{const s=K,r=R,c=V,E=D,F=O,L=G;return g(),h(L,{hoverable:""},{title:n(()=>[w(e.$slots,"title",{},void 0,!0)]),default:n(()=>[f(F,{vertical:"",justify:"center",align:"center",gap:"small"},{default:n(()=>[w(e.$slots,"head",{},void 0,!0),f(E,{"mt-5":"","label-align":"right",model:u(o),onFinish:N},{default:n(()=>[f(r,null,{default:n(()=>[(g(!0),Z(q,null,z(u(o),(J,P,d)=>(g(),h(s,{key:d,value:u(o)[`code${d}`],"onUpdate:value":m=>u(o)[`code${d}`]=m,controls:!1,maxlength:1,class:"verification-input",onInput:m=>x(d,m),onKeydown:m=>T(d,m)},null,8,["value","onUpdate:value","onInput","onKeydown"]))),128))]),_:1}),f(r,null,{default:n(()=>[f(c,{loading:p.verifyLoading,"mb-3":"",block:"","html-type":"submit",type:"primary"},{default:n(()=>[I(C(p.sendText),1)]),_:1},8,["loading"]),p.resend?(g(),h(c,{key:0,block:"",disabled:u(l),type:"dashed",onClick:M},{default:n(()=>[I(C(u(l)?`${u(i)}秒后重发`:"发送"),1)]),_:1},8,["disabled"])):A("",!0)]),_:1})]),_:1},8,["model"])]),_:3})]),_:3})}}}),ee=j(H,[["__scopeId","data-v-e2da1db4"]]);export{ee as v};
