import{_ as P}from"./index.vue_vue_type_script_setup_true_lang-2UVVrzlE.js";import{_ as X}from"./edit.vue_vue_type_script_setup_true_lang-glZ4wNpg.js";import{_ as Y}from"./cover.vue_vue_type_script_setup_true_lang-CNUaXLpf.js";import{a as q,d as K}from"./shop-DQ5OnVJ8.js";import{u as L}from"./index-DCA2stvC.js";import{aX as W,aY as Z,aS as ee,$ as te,a0 as ae,ai as ne,S as oe,x as se,aj as le,J as ue,m as ie,V as _e,ah as de,aa as pe,aC as re,au as ce,s as me,at as fe}from"./antd-_WrWzocG.js";import{d as ge,f as c,s as ve,r as ye,o as xe,a5 as i,ac as m,ad as e,k as t,u as a,G as l,a3 as z,F as B,af as Ce,ag as d,ak as O,H as ke,a8 as he}from"./vue-f4UZefmh.js";import"./context-Be6rZNwT.js";import"./coverEdit.vue_vue_type_script_setup_true_lang-D8rswO4k.js";const we=he("span",{"text-20px":"","line-height-32px":"","mr-12px":"","mb-0":"",truncate:"","font-600":""},"商品管理",-1),De=ge({__name:"index",setup(Se){const f=c(!1),p=c(!1),V=ve([{title:"#",dataIndex:"id"},{title:"商品名称",dataIndex:"name"},{title:"价格",dataIndex:"price",width:120,ellipsis:!0},{title:"流量",dataIndex:"bandwidth"},{title:"分组",dataIndex:"nodeGroup"},{title:"状态",dataIndex:"status"},{title:"操作",dataIndex:"action",width:200}]),x=c(0),w=c(),u=ye({pageSize:10,current:1,total:0,pageSizeOptions:["10","20","30","40"],showSizeChanger:!0,showQuickJumper:!0,showTotal:o=>`${o}条记录`,onChange(o,n){u.pageSize=n,u.current=o,g()}}),r=c({name:void 0,status:void 0});async function g(){if(!f.value){f.value=!0;try{const{data:o}=await q({size:u.pageSize,current:u.current,param:r.value});w.value=o.records,u.total=o.total,u.pageSize=o.size,u.current=o.current}finally{f.value=!1}}}function M(){g()}function N(o){x.value=o.id,p.value=!0}async function D(o){await K(o),L().success("商品删除成功"),await g()}function F(){x.value=void 0,p.value=!0}function G(o){p.value=!1,o&&g()}const _=c(!1);return xe(()=>{g()}),(o,n)=>{const U=te,S=ae,C=ne,b=oe,j=se,k=le,v=ue,h=ie,A=_e,$=de,I=pe,H=re,J=ce,Q=me,R=fe,T=P;return i(),m(T,null,{title:e(()=>[we]),default:e(()=>[t($,{"mb-4":""},{default:e(()=>[t(A,{modal:a(r)},{default:e(()=>[t(k,{gutter:16},{default:e(()=>[t(C,{span:12},{default:e(()=>[t(S,{label:"商品名",name:"name"},{default:e(()=>[t(U,{value:a(r).name,"onUpdate:value":n[0]||(n[0]=s=>a(r).name=s)},null,8,["value"])]),_:1})]),_:1}),t(C,{span:12},{default:e(()=>[t(S,{label:"状态",name:"status"},{default:e(()=>[t(j,{value:a(r).status,"onUpdate:value":n[1]||(n[1]=s=>a(r).status=s)},{default:e(()=>[t(b,{value:1},{default:e(()=>[l(" 上架 ")]),_:1}),t(b,{value:0},{default:e(()=>[l(" 下架 ")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),t(k,{span:24,style:{"text-align":"right"}},{default:e(()=>[t(C,{span:24},{default:e(()=>[t(h,{flex:"","justify-end":"","w-full":""},{default:e(()=>[t(v,{loading:a(f),type:"primary",onClick:M},{default:e(()=>[l(" 查询 ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modal"])]),_:1}),t(k,{gutter:24},{default:e(()=>[t(C,{span:24},{default:e(()=>[t($,{title:"商品列表"},{extra:e(()=>[t(h,null,{default:e(()=>[t(v,{type:"default",size:"middle",onClick:F},{icon:e(()=>[t(a(W))]),default:e(()=>[l(" 添加商品 ")]),_:1}),t(v,{type:"default",size:"middle",onClick:n[2]||(n[2]=s=>_.value=!0)},{icon:e(()=>[t(a(Z))]),default:e(()=>[l(" 管理封页 ")]),_:1})]),_:1})]),default:e(()=>[t(J,{loading:a(f),columns:a(V),"data-source":a(w),pagination:a(u),scroll:{x:100}},{bodyCell:e(({column:s,record:y})=>[s.dataIndex==="bandwidth"?(i(),z(B,{key:0},[l(Ce(y.content.bandwidth)+" GB ",1)],64)):d("",!0),s.dataIndex==="status"?(i(),z(B,{key:1},[y.status===1?(i(),m(I,{key:0,color:"#108ee9"},{default:e(()=>[l(" 上架中 ")]),_:1})):d("",!0),y.status===0?(i(),m(I,{key:1,color:"#f50"},{default:e(()=>[l(" 已下架 ")]),_:1})):d("",!0)],64)):d("",!0),s.dataIndex==="action"?(i(),m(h,{key:2},{default:e(()=>[t(v,{type:"primary",onClick:E=>N(y)},{default:e(()=>[l(" 修改 ")]),_:2},1032,["onClick"]),t(H,{title:"确定要删除节点吗？",onConfirm:E=>D(y.id)},{icon:e(()=>[t(a(ee))]),default:e(()=>[t(v,{danger:"",type:"primary"},{default:e(()=>[l(" 删除 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:2},1024)):d("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1})]),_:1})]),_:1}),t(Q,{title:a(x)?"编辑商品":"添加商品",width:720,visible:a(p),"body-style":{paddingBottom:"80px"},onClose:n[3]||(n[3]=s=>p.value=!1)},{default:e(()=>[a(p)?(i(),m(O(X),{key:0,"shop-id":a(x),onHandleClose:G},null,40,["shop-id"])):d("",!0)]),_:1},8,["title","visible"]),t(R,{open:a(_),"onUpdate:open":n[4]||(n[4]=s=>ke(_)?_.value=s:null),width:800,title:"管理封页","mask-closable":!1,onCancel:n[5]||(n[5]=s=>_.value=!1),onOk:n[6]||(n[6]=s=>_.value=!1)},{default:e(()=>[a(_)?(i(),m(O(Y),{key:0})):d("",!0)]),_:1},8,["open"])]),_:1})}}});export{De as default};
