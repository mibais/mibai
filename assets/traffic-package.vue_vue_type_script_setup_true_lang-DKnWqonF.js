import{bc as A,d as I,S as R,m as F,J as j,a0 as q,ao as E,aa as H,bd as J,av as O,ab as z,am as K}from"./antd-BeZGkD-C.js";import{c as L,b as Q}from"./bought-BUhKHSfB.js";import{u as W,a as X}from"./index-yQqClIEh.js";import{d as Z,f as l,c as ee,w as ne,o as ae,ab as oe,a5 as x,a3 as te,k as e,ad as n,u as a,G as s,a8 as c,ac as le,af as i,ag as se,H as g,F as ue}from"./vue-CP9fVXMC.js";const _e=c("br",null,null,-1),fe=Z({__name:"traffic-package",setup(re){const o=l(10),u=l(!1),y=l(!1),G=l(!1),m=l(0),k=l(),b=W(),f=X(),p=ee(()=>o.value*m.value);ne(p,_=>{G.value=_>f.userInfo.money});const C=l({100:"100GB",300:"300GB",500:{style:{color:"#f50"},label:"500GB"},700:"700GB",1e3:"1000GB"});async function M(){const{data:_}=await L();_&&(y.value=!0,m.value=_.unitPrice,k.value=I(_.nextRestTime).format("YYYY-MM-DD"))}function P(){y.value?u.value=!0:(u.value=!1,b.warning("需要先购买套餐"))}const B=l(!1);async function $(){if(p.value>f.userInfo.money)return B.value=!0;await Q(o.value),u.value=!1,b.success("流量购买成功！")}return ae(()=>{M()}),(_,t)=>{const d=R,h=F,D=oe("router-link"),S=j,T=q,N=E,v=H,U=J,V=O,w=z,Y=K;return x(),te(ue,null,[e(d,{type:"primary",onClick:P},{icon:n(()=>[e(a(A))]),default:n(()=>[s(" 购买流量包 ")]),_:1}),e(Y,{open:a(u),"onUpdate:open":t[3]||(t[3]=r=>g(u)?u.value=r:null),title:"购买流量包",width:"680px"},{footer:n(()=>[e(h,null,{default:n(()=>[e(d,{style:{"margin-right":"8px"},onClick:t[0]||(t[0]=r=>u.value=!1)},{default:n(()=>[s("取消")]),_:1}),e(d,{type:"primary",onClick:$},{default:n(()=>[s("购买")]),_:1})]),_:1})]),default:n(()=>[c("div",null,[a(B)?(x(),le(S,{key:0,type:"info"},{message:n(()=>[s(i(`余额不足。流量包总价${a(p)}元，账户余额${a(f).userInfo.money}元`)+"。请先 ",1),e(D,{to:"/charge/wallet"},{default:n(()=>[s("充值")]),_:1})]),_:1})):se("",!0),e(w,null,{default:n(()=>[e(v,{span:24},{default:n(()=>[e(N,null,{default:n(()=>[c("blockquote",null,[s(" 购买的流量包与当前套餐绑定，并只在当前周期有效。"),_e,s("当前周期到期时间："),e(T,{color:"#108ee9"},{default:n(()=>[s(i(a(k)),1)]),_:1})])]),_:1})]),_:1}),e(v,{span:16},{default:n(()=>[e(U,{value:a(o),"onUpdate:value":t[1]||(t[1]=r=>g(o)?o.value=r:null),min:1,max:1e3,step:5,marks:a(C)},null,8,["value","marks"])]),_:1}),e(v,{offset:2,span:6},{default:n(()=>[e(V,{value:a(o),"onUpdate:value":t[2]||(t[2]=r=>g(o)?o.value=r:null),placeholder:"输入你要购买的流量","addon-after":"GB",min:1,max:1e3,step:5},null,8,["value"])]),_:1})]),_:1}),e(w,null,{default:n(()=>[c("ul",null,[c("li",null,"当前套餐单价："+i(a(m))+"元/GB",1),c("li",null,"流量总计价格："+i(a(p))+"元",1)])]),_:1})])]),_:1},8,["open"])],64)}}});export{fe as _};
